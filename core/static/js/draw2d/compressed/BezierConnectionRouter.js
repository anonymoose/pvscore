/**
This notice must be untouched at all times.
This is the COMPRESSED version of Draw2D
WebSite: http://www.draw2d.org
Copyright: 2006 Andreas Herz. All rights reserved.
Created: 5.11.2006 by Andreas Herz (Web: http://www.freegroup.de )
LICENSE: LGPL
**/

BezierConnectionRouter=function(_8a3){if(!_8a3){this.cheapRouter=new ManhattanConnectionRouter();}else{this.cheapRouter=null;}this.iteration=5;};BezierConnectionRouter.prototype=new ConnectionRouter();BezierConnectionRouter.prototype.type="BezierConnectionRouter";BezierConnectionRouter.prototype.drawBezier=function(_8a4,_8a5,t,iter){var n=_8a4.length-1;var q=[];var _8aa=n+1;for(var i=0;i<_8aa;i++){q[i]=[];q[i][0]=_8a4[i];}for(var j=1;j<=n;j++){for(var i=0;i<=(n-j);i++){q[i][j]=new Point((1-t)*q[i][j-1].x+t*q[i+1][j-1].x,(1-t)*q[i][j-1].y+t*q[i+1][j-1].y);}}var c1=[];var c2=[];for(var i=0;i<n+1;i++){c1[i]=q[0][i];c2[i]=q[i][n-i];}if(iter>=0){this.drawBezier(c1,_8a5,t,--iter);this.drawBezier(c2,_8a5,t,--iter);}else{for(var i=0;i<n;i++){_8a5.push(q[i][n-i]);}}};BezierConnectionRouter.prototype.route=function(conn){if(this.cheapRouter!==null&&(conn.getSource().getParent().isMoving===true||conn.getTarget().getParent().isMoving===true)){this.cheapRouter.route(conn);return;}var _8b0=[];var _8b1=conn.getStartPoint();var toPt=conn.getEndPoint();this._route(_8b0,conn,toPt,this.getEndDirection(conn),_8b1,this.getStartDirection(conn));var _8b3=[];this.drawBezier(_8b0,_8b3,0.5,this.iteration);for(var i=0;i<_8b3.length;i++){conn.addPoint(_8b3[i]);}conn.addPoint(toPt);};BezierConnectionRouter.prototype._route=function(_8b5,conn,_8b7,_8b8,toPt,_8ba){var TOL=0.1;var _8bc=0.01;var _8bd=90;var UP=0;var _8bf=1;var DOWN=2;var LEFT=3;var _8c2=_8b7.x-toPt.x;var _8c3=_8b7.y-toPt.y;var _8c4;var dir;if(((_8c2*_8c2)<(_8bc))&&((_8c3*_8c3)<(_8bc))){_8b5.push(new Point(toPt.x,toPt.y));return;}if(_8b8===LEFT){if((_8c2>0)&&((_8c3*_8c3)<TOL)&&(_8ba===_8bf)){_8c4=toPt;dir=_8ba;}else{if(_8c2<0){_8c4=new Point(_8b7.x-_8bd,_8b7.y);}else{if(((_8c3>0)&&(_8ba===DOWN))||((_8c3<0)&&(_8ba===UP))){_8c4=new Point(toPt.x,_8b7.y);}else{if(_8b8===_8ba){var pos=Math.min(_8b7.x,toPt.x)-_8bd;_8c4=new Point(pos,_8b7.y);}else{_8c4=new Point(_8b7.x-(_8c2/2),_8b7.y);}}}if(_8c3>0){dir=UP;}else{dir=DOWN;}}}else{if(_8b8===_8bf){if((_8c2<0)&&((_8c3*_8c3)<TOL)&&(_8ba==LEFT)){_8c4=toPt;dir=_8ba;}else{if(_8c2>0){_8c4=new Point(_8b7.x+_8bd,_8b7.y);}else{if(((_8c3>0)&&(_8ba===DOWN))||((_8c3<0)&&(_8ba===UP))){_8c4=new Point(toPt.x,_8b7.y);}else{if(_8b8===_8ba){var pos=Math.max(_8b7.x,toPt.x)+_8bd;_8c4=new Point(pos,_8b7.y);}else{_8c4=new Point(_8b7.x-(_8c2/2),_8b7.y);}}}if(_8c3>0){dir=UP;}else{dir=DOWN;}}}else{if(_8b8===DOWN){if(((_8c2*_8c2)<TOL)&&(_8c3<0)&&(_8ba===UP)){_8c4=toPt;dir=_8ba;}else{if(_8c3>0){_8c4=new Point(_8b7.x,_8b7.y+_8bd);}else{if(((_8c2>0)&&(_8ba===_8bf))||((_8c2<0)&&(_8ba===LEFT))){_8c4=new Point(_8b7.x,toPt.y);}else{if(_8b8===_8ba){var pos=Math.max(_8b7.y,toPt.y)+_8bd;_8c4=new Point(_8b7.x,pos);}else{_8c4=new Point(_8b7.x,_8b7.y-(_8c3/2));}}}if(_8c2>0){dir=LEFT;}else{dir=_8bf;}}}else{if(_8b8===UP){if(((_8c2*_8c2)<TOL)&&(_8c3>0)&&(_8ba===DOWN)){_8c4=toPt;dir=_8ba;}else{if(_8c3<0){_8c4=new Point(_8b7.x,_8b7.y-_8bd);}else{if(((_8c2>0)&&(_8ba===_8bf))||((_8c2<0)&&(_8ba===LEFT))){_8c4=new Point(_8b7.x,toPt.y);}else{if(_8b8===_8ba){var pos=Math.min(_8b7.y,toPt.y)-_8bd;_8c4=new Point(_8b7.x,pos);}else{_8c4=new Point(_8b7.x,_8b7.y-(_8c3/2));}}}if(_8c2>0){dir=LEFT;}else{dir=_8bf;}}}}}}this._route(_8b5,conn,_8c4,dir,toPt,_8ba);_8b5.push(_8b7);};